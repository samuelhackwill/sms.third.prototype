<template name="AdminTickerPage">
  <main class="mx-auto max-w-7xl p-6">
    <h1 class="text-2xl font-semibold">Admin Ticker</h1>
    <p class="mt-2 text-sm text-slate-600">Drag cards to reorder screens. Hold card to highlight client.</p>

    <section class="mt-6 rounded border border-slate-300 bg-slate-50 p-4">
      <div class="mb-3 flex items-center justify-between">
        <h2 class="text-sm font-semibold uppercase tracking-wide text-slate-700">Connected Clients ({{clientCount}})</h2>
        <span class="text-xs text-slate-500">proportional widths</span>
      </div>

      <div id="clientsPanel" class="w-full overflow-x-auto">
        <div id="clientsRow" class="flex min-h-24 items-end gap-2">
          {{#if hasClients}}
            {{#each clientsForPanel}}
              <div
                class="js-client-card relative shrink-0 cursor-grab rounded border border-slate-500 bg-white p-2 text-xs active:cursor-grabbing"
                style="width: {{rectWidth}}px; height: {{rectHeight}}px;"
                draggable="true"
                data-client-id="{{_id}}"
                title="{{tooltip}}"
              >
                <button
                  type="button"
                  class="js-remove-client absolute right-1 top-1 rounded border border-slate-300 px-1 text-[10px] leading-none text-slate-600 hover:bg-red-100"
                  data-client-id="{{_id}}"
                >
                  x
                </button>
                <div class="pr-4 font-semibold">{{shortCode}}</div>
                <div class="mt-1 truncate text-slate-600">{{width}}x{{height}}</div>
                <div class="truncate text-slate-500">order: {{orderIndex}}</div>
                <div class="truncate text-slate-500">xStart: {{xStart}}</div>
              </div>
            {{/each}}
          {{else}}
            <div class="py-6 text-sm text-slate-500">No connected clients.</div>
          {{/if}}
        </div>
      </div>
    </section>

    <section class="mt-4 rounded border border-slate-300 bg-slate-50 p-4">
      <h2 class="text-sm font-semibold uppercase tracking-wide text-slate-700">Controls</h2>
      <div class="mt-3 flex flex-wrap items-center gap-2">
        <label for="tickerSpeedInput" class="text-sm text-slate-700">Speed px/s</label>
        <input id="tickerSpeedInput" class="w-24 rounded border border-slate-300 px-2 py-1 text-sm" type="number" min="1" value="{{wall.speedPxPerSec}}" />
        <button type="button" class="js-set-speed rounded border border-slate-300 bg-white px-3 py-1.5 text-sm hover:bg-slate-100">Set Speed</button>

        <button type="button" class="js-send-random-text rounded border border-slate-300 bg-white px-3 py-1.5 text-sm hover:bg-slate-100">Send Random Text</button>
        <button type="button" class="js-clear-queue rounded border border-slate-300 bg-white px-3 py-1.5 text-sm hover:bg-slate-100">Clear Queue</button>
        <button type="button" class="js-panic-stop rounded border border-red-500 bg-red-600 px-3 py-1.5 text-sm font-semibold text-white hover:bg-red-700">PANIC STOP</button>
        <button type="button" class="js-kill-clients rounded border border-red-300 bg-white px-3 py-1.5 text-sm text-red-700 hover:bg-red-50">Kill Clients</button>
      </div>
    </section>

    <section class="mt-4 rounded border border-slate-300 bg-slate-50 p-4">
      <h2 class="text-sm font-semibold uppercase tracking-wide text-slate-700">Status</h2>
      <div class="mt-3 grid gap-2 text-sm">
        <div><span class="font-semibold">totalWallWidth:</span> {{wall.totalWallWidth}}</div>
        <div><span class="font-semibold">playing:</span> {{playingText}}</div>
        <div><span class="font-semibold">queueLength:</span> {{queueLength}}</div>
        <div><span class="font-semibold">queueHead:</span> {{queueHead}}</div>
      </div>
    </section>
  </main>
</template>
